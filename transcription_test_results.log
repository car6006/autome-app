🚀 Starting Large-File Transcription Pipeline Test
============================================================

🔍 Checking test file: /tmp/test_pipeline_30s.wav
✅ Test file found: 2,646,078 bytes (2.5 MB)
✅ Registered test user: test_transcription_1756378651@example.com

📤 Creating upload session...
✅ Upload session created: bb927c09-7aa1-459a-80f0-8f1498fd2219
   Chunk size: 5,242,880 bytes

📁 Uploading file chunks...
   Total chunks: 1
   Chunk size: 2,646,078 bytes
   ✅ Uploaded chunk 1/1
✅ All chunks uploaded successfully

🎯 Finalizing upload...
✅ Upload finalized successfully
   Job ID: 9c15b057-f3fa-4110-b6cc-d1e9c96210f7

👀 Monitoring transcription job: 9c15b057-f3fa-4110-b6cc-d1e9c96210f7
🔍 Looking for debugging logs:
   - 💾 Job {job_id}: Saving checkpoint with X transcripts...
   - ✅ Job {job_id}: Checkpoint verified - X transcripts saved
   - 🔍 Job {job_id}: Looking for transcription checkpoint...
   - ✅ Job {job_id}: Found checkpoint with keys: ...
   - Any error messages about checkpoint verification or retrieval
   [10:57:31] Stage: created, Progress: 0.0%, Status: created
   [10:57:37] Stage: transcoding, Progress: 0.0%, Status: processing
   [10:57:42] Stage: failed, Progress: 10.0%, Status: failed
❌ Transcription failed!
   Error code: STAGE_ERROR
   Error message: PENDING

🔍 DEBUGGING INFO - Job failed in stage: failed

📋 Checking backend logs for debugging information...
ℹ️  Job logs require admin access (403)

🏥 System Health:
   Overall status: healthy
   Pipeline status: {'worker': {'running': True, 'worker_active': True, 'task_running': True}, 'queue': {'created_jobs': 0, 'processing_jobs': 0, 'failed_jobs_ready_for_retry': 0, 'total_queued': 0}}

🧹 Cleaning up test resources...
✅ Upload session cleaned up
✅ Transcription job cleaned up

============================================================
❌ TRANSCRIPTION PIPELINE TEST FAILED
🔍 This provides valuable debugging information about:
   - Where the pipeline breaks down
   - Checkpoint save/retrieve process issues
   - Merge stage success/failure
   - Error messages for troubleshooting
